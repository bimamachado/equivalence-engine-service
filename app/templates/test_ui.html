<!doctype html>
<html lang="pt-BR">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <title>Equivalence Engine — Test UI</title>
    <style>
      body{font-family:Arial,Helvetica,sans-serif;margin:20px}
      textarea{width:100%;height:260px;font-family:monospace}
      pre{background:#f6f8fa;padding:12px;border-radius:6px}
      .row{margin-bottom:12px}
    </style>
  </head>
  <body>
    <h1>Equivalence Engine — Test UI</h1>
    <p>Envie um payload JSON para <code>/v1/equivalences/evaluate</code> e veja a resposta.</p>

    <div class="row">
      <label>API Key (X-API-Key): <input id="apiKey" value="dev-client-abc123" style="width:320px"/></label>
    </div>

    <div class="row">
      <label>Payload JSON:</label>
      <textarea id="payload">{
  "request_id": "manual-1",
  "origem": {"nome":"Curso A","carga_horaria":60,"nivel":"basico","ementa":"Exemplo"},
  "destino": {"nome":"Curso B","carga_horaria":60,"nivel":"intermediario","ementa":"Exemplo"},
  "taxonomy_version": "2026.01",
  "policy_version": "v3"
}</textarea>
    </div>

    <div class="row">
      <button id="send">Enviar</button>
      <span id="status"></span>
    </div>

    <h3>Resposta</h3>
    <pre id="result">(nenhuma)</pre>

    <script>
      const btn = document.getElementById('send');
      const status = document.getElementById('status');
      const result = document.getElementById('result');
      btn.addEventListener('click', async () => {
        status.textContent = 'Enviando...';
        result.textContent = '';
        try {
          const body = JSON.parse(document.getElementById('payload').value);
          const apiKey = document.getElementById('apiKey').value;
          const res = await fetch('/v1/equivalences/evaluate', {
            method: 'POST',
            headers: { 'Content-Type': 'application/json', 'X-API-Key': apiKey },
            body: JSON.stringify(body)
          });
          const text = await res.text();
          status.textContent = `HTTP ${res.status}`;
          try { result.textContent = JSON.stringify(JSON.parse(text), null, 2); } catch(e){ result.textContent = text }
        } catch (err) {
          status.textContent = 'Erro';
          result.textContent = String(err);
        }
      });
    </script>
  </body>
</html>
